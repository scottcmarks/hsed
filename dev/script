:load dev/DevMain.hs
:set -ddump-splices
:set -fno-warn-type-defaults
:set -fno-warn-unused-imports
:set -XDataKinds
:set -XOverloadedStrings
:set -XTemplateHaskell
:def $ (pure . (":! bash -l -c " ++) . show)
:def | (pure . (":! bash -l -c " ++) . show)

import System.IO
putStrLn "loading script ..."
--------------------------------------------------------------------------------

$( [| putStrLn "This is hsed!" |] )  $([|..|]) is a sort of identity


import           Language.Haskell.TH
import           Language.Haskell.TH.Ppr
import           Language.Haskell.TH.PprLib
import           Data.Function((&))
import           Data.Functor((<&>))
import           System.SED.Common.TableUIDs

pQ = (ppr <$>) . runQ
hw = [| putStrLn "Hello, world!" |]
pQ hw

$( hw )  -- echoed by -ddump-splices

showQ = (\h -> h & pQ <&> show >>= putStrLn)
hw & showQ

import Text.HereDoc
table240 = [here|



                              Table 240   Table UIDs
    +------------------------+------------------------+--------------+--------+
    |UID of Table Descriptor |UID of Table            |Table Name    |Template|
    |Object                  |                        |              |        |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 01 |00 00 00 01 00 00 00 00 |Table         |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 02 |00 00 00 02 00 00 00 00 |SPInfo        |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 03 |00 00 00 03 00 00 00 00 |SPTemplates   |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 04 |00 00 00 04 00 00 00 00 |Column        |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 05 |00 00 00 05 00 00 00 00 |Type          |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 06 |00 00 00 06 00 00 00 00 |MethodID      |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 07 |00 00 00 07 00 00 00 00 |AccessControl |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 08 |00 00 00 08 00 00 00 00 |ACE           |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 09 |00 00 00 09 00 00 00 00 |Authority     |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 0A |00 00 00 0A 00 00 00 00 |Certificates  |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 0B |00 00 00 0B 00 00 00 00 |C_PIN         |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 0C |00 00 00 0C 00 00 00 00 |C_RSA_1024    |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 0D |00 00 00 0D 00 00 00 00 |C_RSA_2048    |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 0E |00 00 00 0E 00 00 00 00 |C_AES_128     |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 0F |00 00 00 0F 00 00 00 00 |C_AES_256     |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 10 |00 00 00 10 00 00 00 00 |C_EC_160      |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 11 |00 00 00 11 00 00 00 00 |C_EC_192      |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 12 |00 00 00 12 00 00 00 00 |C_EC_224      |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 13 |00 00 00 13 00 00 00 00 |C_EC_256      |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 14 |00 00 00 14 00 00 00 00 |C_EC_384      |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 15 |00 00 00 15 00 00 00 00 |C_EC_521      |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 16 |00 00 00 16 00 00 00 00 |C_EC_163      |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 17 |00 00 00 17 00 00 00 00 |C_EC_233      |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 18 |00 00 00 18 00 00 00 00 |C_EC_283      |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 19 |00 00 00 19 00 00 00 00 |C_HMAC_160    |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 1A |00 00 00 1A 00 00 00 00 |C_HMAC_256    |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 1B |00 00 00 1B 00 00 00 00 |C_HMAC_384    |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 1C |00 00 00 1C 00 00 00 00 |C_HMAC_512    |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 00 1D |00 00 00 1D 00 00 00 00 |SecretProtect |Base    |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 02 01 |00 00 02 01 00 00 00 00 |TPerInfo      |Admin   |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 02 03 |00 00 02 03 00 00 00 00 |CryptoSuite   |Admin   |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 02 04 |00 00 02 04 00 00 00 00 |Template      |Admin   |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 02 05 |00 00 02 05 00 00 00 00 |SP            |Admin   |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 04 01 |00 00 04 01 00 00 00 00 |ClockTime     |Clock   |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 06 01 |00 00 06 01 00 00 00 00 |H_SHA_1       |Crypto  |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 06 02 |00 00 06 02 00 00 00 00 |H_SHA_256     |Crypto  |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 06 03 |00 00 06 03 00 00 00 00 |H_SHA_384     |Crypto  |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 06 04 |00 00 06 04 00 00 00 00 |H_SHA_512     |Crypto  |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 0A 01 |00 00 0A 01 00 00 00 00 |Log           |Log     |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 0A 02 |00 00 0A 02 00 00 00 00 |LogList       |Log     |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 08 01 |00 00 08 01 00 00 00 00 |LockingInfo   |Locking |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 08 02 |00 00 08 02 00 00 00 00 |Locking       |Locking |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 08 03 |00 00 08 03 00 00 00 00 |MBRControl    |Locking |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 08 04 |00 00 08 04 00 00 00 00 |MBR           |Locking |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 08 05 |00 00 08 05 00 00 00 00 |K_AES_128     |Locking |
    +------------------------+------------------------+--------------+--------+
    |00 00 00 01 00 00 08 06 |00 00 08 06 00 00 00 00 |K_AES_256     |Locking |
    +------------------------+------------------------+--------------+--------+

|]

parserTest table240Parser table240

putStrLn "Buh-bye now."

--------------------------------------------------------------------------------
putStrLn ".. script loaded."
